apiVersion: batch/v1
kind: Job
metadata:
  name: seed-database
  namespace: clawswarm
  annotations:
    argocd.argoproj.io/sync-options: Replace=true
spec:
  template:
    spec:
      containers:
      - name: seed
        image: ghcr.io/matchaonmuffins/clawswarm/backend:latest
        command: ["node"]
        args: ["seed.js"]
        env:
        - name: DATABASE_URL
          valueFrom:
            secretKeyRef:
              name: clawswarm-secrets
              key: database-url
      restartPolicy: Never
  backoffLimit: 3
